name: Android Raw Logger (Final Debug)

on: [push, workflow_dispatch]

jobs:
  raw-debug:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'

      - name: Setup Gradle
        uses: gradle/actions/setup-gradle@v3
        with:
          gradle-version: '8.2'

      # ðŸ—ï¸ BUILD STEP (Output to file)
      - name: ðŸš€ Build Debug APK
        id: buildCmd
        run: |
          echo "Starting Build..."
          # Error ko ignore karne ke liye '|| true' lagaya hai
          gradle assembleDebug --no-daemon --stacktrace 2>&1 | tee build.log || true

      # ðŸ“„ SHOW FULL LOG (No Filtering)
      # Ye step fail nahi hoga. Pura chittha khol dega.
      - name: ðŸ“œ Display Full Failure Log
        if: failure() || success() 
        run: |
          echo "::group::ðŸ”Ž OPEN THIS TO SEE FULL LOGS"
          cat build.log
          echo "::endgroup::"
          
          echo "=================================================="
          echo "ðŸ‘‡ FAILURE REASON (Last 50 Lines) ðŸ‘‡"
          echo "=================================================="
          tail -n 50 build.log
          echo "=================================================="

